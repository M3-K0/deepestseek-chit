<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSeek R1 Custom Chat</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0F0F23 0%, #1A1A2E 50%, #16213E 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            padding: 20px;
            text-align: center;
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .settings-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            width: 44px;
            height: 44px;
            color: white;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .api-setup {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            display: flex;
            gap: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .api-setup input {
            flex: 1;
            padding: 16px 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .api-setup input:focus {
            outline: none;
            border-color: #6C63FF;
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
        }
        
        .api-setup input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .api-setup button {
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, #6C63FF 0%, #5A52E5 100%);
            color: white;
            font-weight: 600;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(108, 99, 255, 0.3);
        }
        
        .api-setup button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(108, 99, 255, 0.4);
        }

        .settings-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            padding: 24px;
            display: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            max-height: 70vh;
            overflow-y: auto;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .setting-group label {
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .setting-group input, .setting-group select {
            padding: 12px 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .setting-group input:focus, .setting-group select:focus {
            outline: none;
            border-color: #6C63FF;
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
        }
        
        .setting-group input[type="range"] {
            -webkit-appearance: none;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            outline: none;
        }
        
        .setting-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: #6C63FF;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(108, 99, 255, 0.5);
        }

        .prompt-section {
            grid-column: 1 / -1;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .prompt-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .prompt-tab {
            padding: 8px 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .prompt-tab.active {
            background: #6C63FF;
            color: white;
            border-color: #6C63FF;
        }
        
        .prompt-content {
            display: none;
        }
        
        .prompt-content.active {
            display: block;
        }

        .prompt-textarea {
            width: 100%;
            min-height: 120px;
            padding: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            font-size: 14px;
            resize: vertical;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
        }
        
        .prompt-textarea:focus {
            outline: none;
            border-color: #6C63FF;
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
        }
        
        .prompt-textarea::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .preset-btn {
            padding: 10px 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .preset-btn:hover {
            background: rgba(108, 99, 255, 0.3);
            border-color: #6C63FF;
            transform: translateY(-1px);
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 85%;
            padding: 15px 20px;
            border-radius: 20px;
            font-size: 16px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .user-message {
            background: rgba(255, 255, 255, 0.9);
            margin-left: auto;
            border-bottom-right-radius: 5px;
            color: #333;
        }

        .bot-message {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-right: auto;
            border-bottom-left-radius: 5px;
            color: white;
        }

        .thinking {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid rgba(255, 193, 7, 0.4);
            color: #fff3cd;
            font-style: italic;
        }

        .input-container {
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .message-input {
            flex: 1;
            padding: 18px 24px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            resize: none;
            min-height: 56px;
            max-height: 120px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .message-input:focus {
            outline: none;
            border-color: #6C63FF;
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
        }
        
        .message-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .send-button {
            width: 56px;
            height: 56px;
            border: none;
            border-radius: 16px;
            background: linear-gradient(135deg, #6C63FF 0%, #5A52E5 100%);
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(108, 99, 255, 0.3);
        }
        
        .send-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(108, 99, 255, 0.4);
        }

        .send-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .status {
            padding: 10px 20px;
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .connected { color: #4CAF50; }
        .error { color: #f44336; }

        .clear-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            width: 44px;
            height: 44px;
            color: white;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .clear-btn:hover {
            background: rgba(255, 77, 77, 0.3);
            border-color: #FF4D4D;
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .message {
                max-width: 90%;
                font-size: 15px;
            }
            
            .input-container {
                padding: 16px;
            }
            
            .header {
                padding: 16px;
            }
            
            .api-setup {
                padding: 16px;
                flex-direction: column;
            }
            
            .api-setup input {
                margin-bottom: 12px;
            }
            
            .settings-panel {
                padding: 20px;
            }
            
            .prompt-tabs {
                flex-wrap: wrap;
            }
            
            .preset-buttons {
                gap: 8px;
            }
            
            .preset-btn {
                font-size: 11px;
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="settings-btn" onclick="toggleSettings()">⚙️</button>
        <h1>🤖 DeepSeek R1 Custom</h1>
        <button class="clear-btn" onclick="clearChat()">🗑️</button>
    </div>

    <div class="api-setup">
        <input type="password" id="apiKey" placeholder="Enter your DeepSeek API key..." />
        <button onclick="setApiKey()">Set Key</button>
    </div>

    <div class="settings-panel" id="settingsPanel">
        <div class="settings-grid">
            <div class="setting-group">
                <label>Model</label>
                <select id="model">
                    <option value="deepseek-reasoner">DeepSeek R1 (Reasoner)</option>
                    <option value="deepseek-chat">DeepSeek Chat</option>
                </select>
            </div>
            
            <div class="setting-group">
                <label>Temperature</label>
                <input type="range" id="temperature" min="0" max="2" step="0.1" value="0.7" oninput="updateTempLabel()">
                <span id="tempLabel">0.7</span>
            </div>
            
            <div class="setting-group">
                <label>Max Tokens</label>
                <input type="number" id="maxTokens" value="4000" min="1" max="8000">
            </div>
            
            <div class="setting-group">
                <label>Top P</label>
                <input type="range" id="topP" min="0" max="1" step="0.05" value="0.95" oninput="updateTopPLabel()">
                <span id="topPLabel">0.95</span>
            </div>
            
            <div class="setting-group">
                <label>Frequency Penalty</label>
                <input type="range" id="freqPenalty" min="-2" max="2" step="0.1" value="0" oninput="updateFreqLabel()">
                <span id="freqLabel">0.0</span>
            </div>
            
            <div class="setting-group">
                <label>Presence Penalty</label>
                <input type="range" id="presPenalty" min="-2" max="2" step="0.1" value="0" oninput="updatePresLabel()">
                <span id="presLabel">0.0</span>
            </div>
            
            <div class="setting-group prompt-section">
                <label>AI Personality & Behavior</label>
                
                <div class="prompt-tabs">
                    <button class="prompt-tab active" onclick="switchPromptTab('base')">📋 Base Instructions</button>
                    <button class="prompt-tab" onclick="switchPromptTab('personality')">🎭 Personality</button>
                </div>
                
                <div class="prompt-content active" id="basePromptContent">
                    <textarea id="basePrompt" class="prompt-textarea" placeholder="Enter core instructions for how the AI should respond (e.g., format, length, technical level)...">You are a helpful AI assistant. Provide clear, accurate, and well-structured responses. Be concise but thorough in your explanations.</textarea>
                </div>
                
                <div class="prompt-content" id="personalityPromptContent">
                    <textarea id="personalityPrompt" class="prompt-textarea" placeholder="Define the AI's personality, tone, and communication style (e.g., friendly, professional, creative, analytical)...">Be friendly and engaging while maintaining professionalism. Use a conversational tone and show enthusiasm for helping users solve problems.</textarea>
                </div>
                
                <div class="preset-buttons">
                    <button class="preset-btn" onclick="setPreset('coding')">🔧 Coding Assistant</button>
                    <button class="preset-btn" onclick="setPreset('creative')">🎨 Creative Writer</button>
                    <button class="preset-btn" onclick="setPreset('analyst')">📊 Data Analyst</button>
                    <button class="preset-btn" onclick="setPreset('teacher')">👨‍🏫 Teacher</button>
                    <button class="preset-btn" onclick="setPreset('researcher')">🔬 Researcher</button>
                </div>
            </div>
        </div>
    </div>

    <div class="status" id="status">Enter your API key to start chatting</div>

    <div class="chat-container" id="chatContainer">
        <div class="bot-message">
            👋 Hi! I'm DeepSeek R1 with full customization. Set your API key, configure your settings, and let's chat!
        </div>
    </div>

    <div class="input-container">
        <div class="input-wrapper">
            <textarea 
                id="messageInput" 
                class="message-input" 
                placeholder="Type your message..."
                disabled
            ></textarea>
            <button class="send-button" id="sendButton" onclick="sendMessage()" disabled>
                ➤
            </button>
        </div>
    </div>

    <script>
        let apiKey = '';
        let isConnected = false;
        let isThinking = false;
        let conversationHistory = [];

        const presets = {
            coding: {
                base: "You are an expert software engineer and coding assistant. Provide clean, efficient code with clear explanations. Always consider best practices, security, and performance. Format code blocks properly and include comments where helpful.",
                personality: "Be methodical and precise, but also encouraging. Show excitement about elegant solutions and help users understand not just what to do, but why. Use technical language appropriately but explain complex concepts clearly."
            },
            creative: {
                base: "You are a creative writing assistant. Help with storytelling, poetry, creative projects, and artistic endeavors. Provide constructive feedback and inspire new ideas. Structure your responses to be engaging and imaginative.",
                personality: "Be imaginative, inspiring, and enthusiastic about creative expression. Use vivid language and encourage experimentation. Show genuine interest in artistic vision and help bring ideas to life with passion."
            },
            analyst: {
                base: "You are a data analyst and researcher. Provide thorough analysis, break down complex topics systematically, use logical reasoning, and support conclusions with evidence. Present findings clearly with proper structure.",
                personality: "Be analytical and objective, but also approachable. Show curiosity about data patterns and insights. Present information in a way that's both rigorous and accessible, helping users understand the bigger picture."
            },
            teacher: {
                base: "You are a patient teacher and tutor. Explain concepts clearly using examples, break down complex topics into digestible parts, and provide step-by-step guidance. Adapt explanations to the user's level.",
                personality: "Be patient, encouraging, and supportive. Celebrate learning progress and create a safe space for questions. Use analogies and real-world examples to make concepts relatable and memorable."
            },
            researcher: {
                base: "You are a research assistant. Help with finding information, analyzing sources, summarizing findings, and organizing research systematically. Provide comprehensive yet focused responses with proper citations when relevant.",
                personality: "Be thorough and methodical, but also curious and engaging. Show enthusiasm for discovery and learning. Present research findings in an organized, accessible way that highlights key insights."
            }
        };

        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function setPreset(type) {
            if (presets[type]) {
                document.getElementById('basePrompt').value = presets[type].base;
                document.getElementById('personalityPrompt').value = presets[type].personality;
            }
        }
        
        function switchPromptTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.prompt-tab').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[onclick="switchPromptTab('${tab}')"]`).classList.add('active');
            
            // Update content visibility
            document.querySelectorAll('.prompt-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tab + 'PromptContent').classList.add('active');
        }

        function updateTempLabel() {
            document.getElementById('tempLabel').textContent = document.getElementById('temperature').value;
        }

        function updateTopPLabel() {
            document.getElementById('topPLabel').textContent = document.getElementById('topP').value;
        }

        function updateFreqLabel() {
            document.getElementById('freqLabel').textContent = document.getElementById('freqPenalty').value;
        }

        function updatePresLabel() {
            document.getElementById('presLabel').textContent = document.getElementById('presPenalty').value;
        }

        function clearChat() {
            if (confirm('Clear all messages?')) {
                document.getElementById('chatContainer').innerHTML = '';
                conversationHistory = [];
            }
        }

        function setApiKey() {
            const keyInput = document.getElementById('apiKey');
            apiKey = keyInput.value.trim();
            
            if (apiKey) {
                isConnected = true;
                document.getElementById('status').innerHTML = '<span class="connected">✓ API key set! Ready to chat</span>';
                document.getElementById('messageInput').disabled = false;
                document.getElementById('sendButton').disabled = false;
                document.getElementById('messageInput').focus();
                keyInput.value = '';
            } else {
                alert('Please enter a valid API key');
            }
        }

        function addMessage(content, isUser = false, isThinking = false) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            
            if (isThinking) {
                messageDiv.className = 'message thinking';
                messageDiv.innerHTML = '🤔 Thinking...';
            } else {
                messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
                messageDiv.innerHTML = content.replace(/\n/g, '<br>');
                
                // Add to conversation history
                if (!isThinking) {
                    conversationHistory.push({
                        role: isUser ? 'user' : 'assistant',
                        content: content
                    });
                }
            }
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            return messageDiv;
        }

        async function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message || !isConnected || isThinking) return;
            
            addMessage(message, true);
            messageInput.value = '';
            
            isThinking = true;
            document.getElementById('sendButton').disabled = true;
            const thinkingDiv = addMessage('', false, true);
            
            try {
                // Build messages array with combined system prompt and conversation history
                const messages = [];
                
                const basePrompt = document.getElementById('basePrompt').value.trim();
                const personalityPrompt = document.getElementById('personalityPrompt').value.trim();
                
                if (basePrompt || personalityPrompt) {
                    let combinedPrompt = '';
                    if (basePrompt) {
                        combinedPrompt += basePrompt;
                    }
                    if (personalityPrompt) {
                        if (combinedPrompt) combinedPrompt += '\n\n';
                        combinedPrompt += 'Personality and Communication Style: ' + personalityPrompt;
                    }
                    
                    messages.push({
                        role: 'system',
                        content: combinedPrompt
                    });
                }
                
                // Add conversation history
                messages.push(...conversationHistory);
                
                // Add current message
                messages.push({
                    role: 'user',
                    content: message
                });

                const requestBody = {
                    model: document.getElementById('model').value,
                    messages: messages,
                    max_tokens: parseInt(document.getElementById('maxTokens').value),
                    temperature: parseFloat(document.getElementById('temperature').value),
                    top_p: parseFloat(document.getElementById('topP').value),
                    frequency_penalty: parseFloat(document.getElementById('freqPenalty').value),
                    presence_penalty: parseFloat(document.getElementById('presPenalty').value)
                };

                const response = await fetch('https://api.deepseek.com/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                thinkingDiv.remove();
                
                if (data.choices && data.choices[0] && data.choices[0].message) {
                    const content = data.choices[0].message.content;
                    addMessage(content, false);
                } else {
                    addMessage('Sorry, I received an unexpected response format.', false);
                }
                
            } catch (error) {
                console.error('Error:', error);
                thinkingDiv.remove();
                addMessage(`Error: ${error.message}. Please check your API key and try again.`, false);
                document.getElementById('status').innerHTML = '<span class="error">❌ Connection error</span>';
            }
            
            isThinking = false;
            document.getElementById('sendButton').disabled = false;
            messageInput.focus();
        }

        // Event listeners
        document.getElementById('messageInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        document.getElementById('apiKey').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                setApiKey();
            }
        });

        document.getElementById('messageInput').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });
    </script>
</body>
</html>