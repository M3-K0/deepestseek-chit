<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSeek R1 Custom Chat</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            text-align: center;
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .settings-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: white;
            cursor: pointer;
            font-size: 18px;
        }

        .api-setup {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
            display: flex;
            gap: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .api-setup input {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }

        .api-setup button {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            background: #4CAF50;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 14px;
        }

        .settings-panel {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            display: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            max-height: 60vh;
            overflow-y: auto;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .setting-group label {
            font-weight: bold;
            color: #333;
            font-size: 14px;
        }

        .setting-group input, .setting-group select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        .system-prompt {
            grid-column: 1 / -1;
        }

        .system-prompt textarea {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .preset-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 20px;
            background: #e3f2fd;
            color: #1976d2;
            cursor: pointer;
            font-size: 12px;
        }

        .preset-btn:hover {
            background: #bbdefb;
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 85%;
            padding: 15px 20px;
            border-radius: 20px;
            font-size: 16px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .user-message {
            background: rgba(255, 255, 255, 0.9);
            margin-left: auto;
            border-bottom-right-radius: 5px;
            color: #333;
        }

        .bot-message {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-right: auto;
            border-bottom-left-radius: 5px;
            color: white;
        }

        .thinking {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid rgba(255, 193, 7, 0.4);
            color: #fff3cd;
            font-style: italic;
        }

        .input-container {
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .message-input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            resize: none;
            min-height: 50px;
            max-height: 120px;
        }

        .send-button {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: #4CAF50;
            color: white;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .send-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .status {
            padding: 10px 20px;
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .connected { color: #4CAF50; }
        .error { color: #f44336; }

        .clear-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }

        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .message {
                max-width: 90%;
                font-size: 15px;
            }
            
            .input-container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="settings-btn" onclick="toggleSettings()">‚öôÔ∏è</button>
        <h1>ü§ñ DeepSeek R1 Custom</h1>
        <button class="clear-btn" onclick="clearChat()">üóëÔ∏è</button>
    </div>

    <div class="api-setup">
        <input type="password" id="apiKey" placeholder="Enter your DeepSeek API key..." />
        <button onclick="setApiKey()">Set Key</button>
    </div>

    <div class="settings-panel" id="settingsPanel">
        <div class="settings-grid">
            <div class="setting-group">
                <label>Model</label>
                <select id="model">
                    <option value="deepseek-reasoner">DeepSeek R1 (Reasoner)</option>
                    <option value="deepseek-chat">DeepSeek Chat</option>
                </select>
            </div>
            
            <div class="setting-group">
                <label>Temperature</label>
                <input type="range" id="temperature" min="0" max="2" step="0.1" value="0.7" oninput="updateTempLabel()">
                <span id="tempLabel">0.7</span>
            </div>
            
            <div class="setting-group">
                <label>Max Tokens</label>
                <input type="number" id="maxTokens" value="4000" min="1" max="8000">
            </div>
            
            <div class="setting-group">
                <label>Top P</label>
                <input type="range" id="topP" min="0" max="1" step="0.05" value="0.95" oninput="updateTopPLabel()">
                <span id="topPLabel">0.95</span>
            </div>
            
            <div class="setting-group">
                <label>Frequency Penalty</label>
                <input type="range" id="freqPenalty" min="-2" max="2" step="0.1" value="0" oninput="updateFreqLabel()">
                <span id="freqLabel">0.0</span>
            </div>
            
            <div class="setting-group">
                <label>Presence Penalty</label>
                <input type="range" id="presPenalty" min="-2" max="2" step="0.1" value="0" oninput="updatePresLabel()">
                <span id="presLabel">0.0</span>
            </div>
            
            <div class="setting-group system-prompt">
                <label>System Prompt</label>
                <textarea id="systemPrompt" placeholder="Enter your custom system prompt here...">You are a helpful AI assistant. Be concise but thorough in your responses.</textarea>
                
                <div class="preset-buttons">
                    <button class="preset-btn" onclick="setPreset('coding')">üîß Coding Assistant</button>
                    <button class="preset-btn" onclick="setPreset('creative')">üé® Creative Writer</button>
                    <button class="preset-btn" onclick="setPreset('analyst')">üìä Data Analyst</button>
                    <button class="preset-btn" onclick="setPreset('teacher')">üë®‚Äçüè´ Teacher</button>
                    <button class="preset-btn" onclick="setPreset('researcher')">üî¨ Researcher</button>
                </div>
            </div>
        </div>
    </div>

    <div class="status" id="status">Enter your API key to start chatting</div>

    <div class="chat-container" id="chatContainer">
        <div class="bot-message">
            üëã Hi! I'm DeepSeek R1 with full customization. Set your API key, configure your settings, and let's chat!
        </div>
    </div>

    <div class="input-container">
        <div class="input-wrapper">
            <textarea 
                id="messageInput" 
                class="message-input" 
                placeholder="Type your message..."
                disabled
            ></textarea>
            <button class="send-button" id="sendButton" onclick="sendMessage()" disabled>
                ‚û§
            </button>
        </div>
    </div>

    <script>
        let apiKey = '';
        let isConnected = false;
        let isThinking = false;
        let conversationHistory = [];

        const presets = {
            coding: "You are an expert software engineer and coding assistant. Provide clean, efficient code with explanations. Always consider best practices, security, and performance.",
            creative: "You are a creative writing assistant. Help with storytelling, poetry, creative projects. Be imaginative, inspiring, and help bring ideas to life.",
            analyst: "You are a data analyst and researcher. Provide thorough analysis, break down complex topics, use logical reasoning, and support conclusions with evidence.",
            teacher: "You are a patient teacher and tutor. Explain concepts clearly, use examples, break down complex topics into digestible parts, and encourage learning.",
            researcher: "You are a research assistant. Help with finding information, analyzing sources, summarizing findings, and organizing research systematically."
        };

        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function setPreset(type) {
            document.getElementById('systemPrompt').value = presets[type];
        }

        function updateTempLabel() {
            document.getElementById('tempLabel').textContent = document.getElementById('temperature').value;
        }

        function updateTopPLabel() {
            document.getElementById('topPLabel').textContent = document.getElementById('topP').value;
        }

        function updateFreqLabel() {
            document.getElementById('freqLabel').textContent = document.getElementById('freqPenalty').value;
        }

        function updatePresLabel() {
            document.getElementById('presLabel').textContent = document.getElementById('presPenalty').value;
        }

        function clearChat() {
            if (confirm('Clear all messages?')) {
                document.getElementById('chatContainer').innerHTML = '';
                conversationHistory = [];
            }
        }

        function setApiKey() {
            const keyInput = document.getElementById('apiKey');
            apiKey = keyInput.value.trim();
            
            if (apiKey) {
                isConnected = true;
                document.getElementById('status').innerHTML = '<span class="connected">‚úì API key set! Ready to chat</span>';
                document.getElementById('messageInput').disabled = false;
                document.getElementById('sendButton').disabled = false;
                document.getElementById('messageInput').focus();
                keyInput.value = '';
            } else {
                alert('Please enter a valid API key');
            }
        }

        function addMessage(content, isUser = false, isThinking = false) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            
            if (isThinking) {
                messageDiv.className = 'message thinking';
                messageDiv.innerHTML = 'ü§î Thinking...';
            } else {
                messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
                messageDiv.innerHTML = content.replace(/\n/g, '<br>');
                
                // Add to conversation history
                if (!isThinking) {
                    conversationHistory.push({
                        role: isUser ? 'user' : 'assistant',
                        content: content
                    });
                }
            }
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            return messageDiv;
        }

        async function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message || !isConnected || isThinking) return;
            
            addMessage(message, true);
            messageInput.value = '';
            
            isThinking = true;
            document.getElementById('sendButton').disabled = true;
            const thinkingDiv = addMessage('', false, true);
            
            try {
                // Build messages array with system prompt and conversation history
                const messages = [];
                
                const systemPrompt = document.getElementById('systemPrompt').value.trim();
                if (systemPrompt) {
                    messages.push({
                        role: 'system',
                        content: systemPrompt
                    });
                }
                
                // Add conversation history
                messages.push(...conversationHistory);
                
                // Add current message
                messages.push({
                    role: 'user',
                    content: message
                });

                const requestBody = {
                    model: document.getElementById('model').value,
                    messages: messages,
                    max_tokens: parseInt(document.getElementById('maxTokens').value),
                    temperature: parseFloat(document.getElementById('temperature').value),
                    top_p: parseFloat(document.getElementById('topP').value),
                    frequency_penalty: parseFloat(document.getElementById('freqPenalty').value),
                    presence_penalty: parseFloat(document.getElementById('presPenalty').value)
                };

                const response = await fetch('https://api.deepseek.com/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                thinkingDiv.remove();
                
                if (data.choices && data.choices[0] && data.choices[0].message) {
                    const content = data.choices[0].message.content;
                    addMessage(content, false);
                } else {
                    addMessage('Sorry, I received an unexpected response format.', false);
                }
                
            } catch (error) {
                console.error('Error:', error);
                thinkingDiv.remove();
                addMessage(`Error: ${error.message}. Please check your API key and try again.`, false);
                document.getElementById('status').innerHTML = '<span class="error">‚ùå Connection error</span>';
            }
            
            isThinking = false;
            document.getElementById('sendButton').disabled = false;
            messageInput.focus();
        }

        // Event listeners
        document.getElementById('messageInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        document.getElementById('apiKey').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                setApiKey();
            }
        });

        document.getElementById('messageInput').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });
    </script>
</body>
</html>